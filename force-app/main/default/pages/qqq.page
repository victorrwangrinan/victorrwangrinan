<apex:page showHeader="false" sidebar="false" controller="ad">
    <!-- <apex:includeScript value="{!URLFOR($Resource.docxConvert, 'htmTodocx/dist/htmldocx.js')}" />
    <apex:includeScript value="{!URLFOR($Resource.docxConvert, 'htmTodocx/test/vendor/FileSaver.js')}" /> -->
    <!-- <apex:includeScript value="{!URLFOR($Resource.docxConvert3, 'docxConvert/htmTodocx/dist/htmldocx.js')}" />
    <apex:includeScript value="{!URLFOR($Resource.docxConvert3, 'docxConvert/htmTodocx/test/vendor/FileSaver.js')}" /> -->
    <apex:includeScript value="{!URLFOR($Resource.docxConvert2, 'docxConvert/htmTodocx/dist/htmldocx.js')}" />
    <apex:includeScript value="{!URLFOR($Resource.docxConvert2, 'docxConvert/htmTodocx/test/vendor/FileSaver.js')}" />

    <script>
        function downLoad() {
            var frameObj = document.getElementById('vfFrame');
            var frameContent = frameObj.contentWindow.document.body.innerHTML;
            console.log("frame content : " + frameContent);

            //var uri = 'data:image/png;base64,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';
            console.log('1-----');
            var htmlStr = '<!DOCTYPE html>' + frameContent;
            var converted = htmlDocx.asBlob(htmlStr,{orientation: 'portrait',pageSize: 'A4', margins: {top: 360,left: 720,bottom: 720,right: 720,header:0}});
            // let converted = new Blob([htmlStr], {
            //     type: "application/octet-stream"
            // });
            saveAs(converted, 'test123.docx');
            
        }
    </script>
    <!-- <img src='https://farm8.staticflickr.com/7187/6895047173_d4b1a0d798.jpg' width="146.5" height="89.5" /> -->
    <iframe id="vfFrame" width="100px" height="100px" src="https://victorwang-dev-ed--c.ap5.visual.force.com/apex/OppView" class="slds-hide" />
    <button onclick="downLoad()">downLoad</button>
    <!-- <div style="width:500px;height:500px;background:url('{!imgFirstPageHeader}')">
        111
    </div> -->
</apex:page>